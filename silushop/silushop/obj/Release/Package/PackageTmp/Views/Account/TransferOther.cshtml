
@{
    Layout = null;
    RelexBarDLL. Users user = Session["user"] as RelexBarDLL.Users;
    decimal totalJF;
    var jfAll = new RelexBarBLL.UsersBLL().GetSiLuJiFen2(user.ID, out totalJF);
}
@model RelexBarDLL.Users
<!DOCTYPE html>

<html>
<head>
    @Html.Action("Header", "Static")
    <style>
        .btn0 {
            background: #808080;
            width: 100%;
            height: 4rem;
            border: 0;
            border-radius: 4rem;
            font-size: 1.8rem;
            color: #fff;
        }

        .code {
            color: #666;
            margin-top: 1.5rem;
            height: 3rem;
        }

            .code > #code {
                border: none;
                border-bottom: 1px solid #ccc;
            }

            .code > input {
                height: 2.5rem;
            }

            .code > #yzm {
                float: right;
                padding: 0rem 1rem;
            }
    </style>
    <script>
        function sub() {
            unable();
            var money = $("#money").val();
            if (money == null || money == "") {
                alert("首购券不能为空！");
                enable();
                return;
            }
            if (isNaN(money)) {
                alert("首购券必须是数字！");
                enable();
                return;
            }
            var phone=$("#phone").val();
            if(phone==""){
                enable();
                return alert("手机号不能为空");
            }
            var name=$("#name").val();
            if(name==""){
                enable();
                return alert("姓名不能为空");
            }
            if(parseFloat(money)>@jfAll){
                alert("首购券不足");
            enable();
            return;
        }
        var code=$("#code").val();
        if(code==null||code==""){enable();
            return alert("验证码不能为空");
        }
        $.post("/Account/DoTransferOther", "phone="+phone+"&name="+name + "&money=" + money+"&code="+code, function (data) {
            alert(data.msg);
            if(data.code=="1")
            {
                location.href="/shop/PersonCenter";
            }
            else
                enable();
        }, "json");

        }

        function enable(){
            $("#sub").css("background","#ff6600");
            $("#sub").attr("disabled", false);
        }
        function unable(){
            $("#sub").css("background","#808080");
            $("#sub").attr("disabled", true);
        }
        $(function(){
            $("#yzm").on("click", function () {

                var c = 60;
                $(this).attr("disabled", "disabled");
                var timer = setInterval(function () {
                    c--;
                    if (c == 0) {
                        $("#yzm").val("获取验证码");
                        $("#yzm").removeAttr("disabled");
                        clearInterval(timer);
                    } else {
                        $("#yzm").val(c + "秒后重试");
                    }

                }, 1000);
                $.post("/Verifycode/getMyVerifyCode?v=" + Math.random(),null,function(data){},"json");

            });
        });
    </script>
    <title>转让易物券</title>
    <style>
        .sl{    font-size: 1.6rem;color: #666;float:left;}
        .input_r{position:absolute;}
    </style>
</head>
<body class="bgf4f4f4">
    <div class="header">
        <h3>转让易物券</h3>
        <a onclick="window.history.back()" title=""><i class="icon-chevron-thin-left"></i></a>
    </div>
    <div class="withdraw_other">
        
        <div class="withdraw_other_title">易物券金额</div>
        <div class="withdraw_other_entry"><input id="money" type="number" class="withdraw_other_entry_txt" /><strong>￥</strong></div>
        <div class="code">
            <span>对方手机号：</span>
            <input type="text" id="phone" style="width:70%" class="withdraw_other_entry_txt" />
        </div>
        <div class="code">
            <span>对 方 姓 名：</span>
            <input type="text" id="name" style="width:70%" class="withdraw_other_entry_txt" />
        </div>
        <div class="code">
            <span>验证码：</span>
            <input type="text" id="code" />
            <input value="获取验证码" id="yzm" type="button">
        </div>
        <div class="withdraw_other_info">可用易物券 @jfAll 元</div>

    </div>
    <div class="btn1" id="qrdiv" style="margin-top:1.5rem"><input id="sub" type="button" value="确认" onclick="sub()" /></div>
</body>
</html>
