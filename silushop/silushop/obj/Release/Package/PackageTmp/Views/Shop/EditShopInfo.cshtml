@model RelexBarDLL.Shop
    <style>
        #shopinfo>form>.col-md-12:nth-child(n+2){
            border-top:1px solid #ccc;
            margin-top:1rem;
            padding-top:1rem;
        }
        #shopinfo img{max-width:100%;}
    </style>
<script>
    var ShopInfo = {};

    ShopInfo.ImgUpload = function (id, file) {
        var data = new FormData();
        console.log(file.files[0]);
        data.append("file", file.files[0], file.files[0].name);
        $.ajax({
            url: "/File/ImgUpload",
            type: "POST",
            data: data,
            processData: false,
            contentType: false,
            success: function (respdata) {
                if (respdata.code == '1') {
                    $("#" + id).val(respdata.msg);
                    $("." + id).attr("src",respdata.msg);
                } else {
                    alert(respdata.msg);
                }
            },
            error: function (data) {
                alert("错误");
            }
        });
    }
    $(function () {
        $("#save").on("click", function () {
            var data = $("#fdata").serialize();
            $.post("/Shop/UpdateShopInfo", data, function (rdata) {
                alert(rdata.msg);
            });
        });
    });
</script>
    <div class="col-md-12">
        <div class="panel panel-primary">
            <div class="panel-heading">
                <h4>商家信息编辑</h4>
            </div>
            <div class="panel-body" id="shopinfo">
                <form id="fdata">
                    <div class="col-md-12">
                        <div class="col-md-3">商家头像:</div>
                        <div class="col-md-9">
                            @Html.HiddenFor(m => m.Img)
                            <input type="file" style="display:none" id="himg" onchange="ShopInfo.ImgUpload('Img',this)" />
                           <div class="col-mg-2">
                               <img class="Img" src="@(string.IsNullOrEmpty(Model.Img)?"/img/defaulthead.jpg":Model.Img) " onclick="$('#himg').click()" />
                           </div>
                             
                        </div>
                    </div>
                    <div class="col-md-12">
                        <div class="col-md-3">商家名称：</div>
                        <div class="col-md-9">
                            @Html.TextBoxFor(m => m.ShopName, new { @class = "form-control" })
                        </div>
                    </div>
                    <div class="col-md-12">
                        <div class="col-md-3">客服QQ：</div>
                        <div class="col-md-9">
                            @Html.TextBoxFor(m => m.ChatQQ, new { @class = "form-control" })
                        </div>
                    </div>
                    <div class="col-md-12">
                        <div class="col-md-3">客服电话：</div>
                        <div class="col-md-9">
                            @Html.TextBoxFor(m => m.ServicePhone, new { @class = "form-control" })
                        </div>
                    </div>
                    <div class="col-md-12">
                        <div class="col-md-3">商家背景图:</div>
                        <div class="col-md-9">
                            @Html.HiddenFor(m => m.BackImg)
                            <input type="file" style="display:none" id="bimg" onchange="ShopInfo.ImgUpload('BackImg', this)" />
                            <div class="col-mg-8">
                                <img src="@(string.IsNullOrEmpty(Model.BackImg)?"/img/defaultback.jpg":Model.BackImg)" class="BackImg" style="min-width:10rem;min-height:2rem;" onclick="$('#bimg').click()" />
                            </div>
                            
                        </div>
                    </div>
                </form>
            </div>
            <div class="panel-footer">
                <input type="button" id="save" value="保存" class="btn btn-primary"/>
            </div>
        </div>
    </div>
